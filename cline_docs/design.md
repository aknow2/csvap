# CSVマッピングアプリ 仕様書（たたき台・React + Mapbox + deck.gl版）

## 目的

CSVファイルに含まれる緯度・経度などの情報をもとに、地図上にポイントや情報を表示するシンプルなWebアプリを作成する。

---

## 機能要件

### 1. CSVアップロード

* ユーザーはローカルのCSVファイルを選択・アップロードできる。
* アップロード後、CSVのヘッダー行を確認・選択できる。

  * 緯度・経度・表示名など、各カラムの意味をマッピングできる（自動検出＋手動修正）。

### 2. 地図表示

* Mapboxの地図を画面上に表示する（Mapbox GL JSを利用）。
* deck.glを使い、CSVの各行に対して地図上にマーカーやレイヤーを配置する。

### 3. マーカーポップアップ表示

* 各マーカーをクリックすると、その行の情報（例：名前、住所、メモ等）をポップアップで表示できる。

### 4. 表示制御

* マーカーの絞り込み・検索（例：名前検索、属性でフィルタリング等）を行える。
* 地図の拡大縮小、移動ができる。

### 5. エラー対応

* CSVが不正な場合や、緯度・経度が不明な場合はエラー表示を行う。

---

## 非機能要件

* Webブラウザ（PC/スマホ両対応、モバイルファースト推奨）
* データはブラウザ上で処理（サーバーアップロード不要／クライアント完結）
* 直感的なUI（ドラッグ&ドロップ対応も可）

---

## 技術要件

* **フレームワーク**: React, vite
* **地図表示**: Mapbox GL JS
* **ビジュアライゼーション**: deck.gl

  * ScatterplotLayer、IconLayerなどを利用予定
* **CSVパース**: PapaParse などのJavaScriptライブラリ
* **状態管理**: React標準のuseState/useReducer
* **開発言語**: TypeScript

---

## CSVファイルの想定例

```csv
名前,住所,緯度,経度,メモ
A店,東京都千代田区,35.6895,139.6917,本店
B店,大阪市北区,34.7055,135.4983,支店
```

---

## 画面イメージ（簡易）

1. **CSVアップロード画面**
   \[ファイル選択]\[アップロード]

2. **マッピング設定画面**
   緯度カラム：\[プルダウン選択]
   経度カラム：\[プルダウン選択]
   名称カラム：\[プルダウン選択]

3. **地図画面**

   * Mapbox地図＋deck.glでマーカー表示
   * サイドにリスト表示や検索バー（任意）

---

## 今後の拡張案（Optional）

* 画像添付やマーカー色分け
* マップ上で直接データ編集
* CSV出力やKML/GeoJSONエクスポート
* 他のレイヤーとの重ね合わせ（例：ヒートマップ）
